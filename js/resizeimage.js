document.addEventListener('DOMContentLoaded',()=>{const f=document.getElementById('file-input'),w=document.getElementById('width'),h=document.getElementById('height'),a=document.getElementById('aspect-ratio'),p=document.getElementById('process-btn'),d=document.getElementById('download-link');let oW,oH;f.addEventListener('change',e=>{if(!e.target.files.length)return;const r=new FileReader();r.onload=t=>{const i=new Image();i.onload=()=>{oW=i.width;oH=i.height;w.value=oW;h.value=oH};i.src=t.target.result};r.readAsDataURL(e.target.files[0])});w.addEventListener('input',()=>{if(a.checked&&oW)h.value=Math.round(w.value*(oH/oW))});h.addEventListener('input',()=>{if(a.checked&&oH)w.value=Math.round(h.value*(oW/oH))});p.addEventListener('click',()=>{if(!f.files.length){alert("Please select an image.");return}const t=f.files[0],nW=parseInt(w.value),nH=parseInt(h.value);const r=new FileReader();r.onload=e=>{const i=new Image();i.onload=()=>{const c=document.createElement('canvas');c.width=nW;c.height=nH;c.getContext('2d').drawImage(i,0,0,nW,nH);c.toBlob(b=>{d.href=URL.createObjectURL(b);d.download=`resized-${t.name}`;d.classList.remove('hidden');showResetButton()},t.type)};i.src=e.target.result};r.readAsDataURL(t)})});