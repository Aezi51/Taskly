document.addEventListener('DOMContentLoaded',async()=>{document.getElementById('process-btn').addEventListener('click',async()=>{const f=document.getElementById('file-input').files[0],d=document.getElementById('download-link'),s=document.getElementById('status');if(!f){alert('Please select an image.');return}try{s.textContent='Converting to PDF...';const{PDFDocument}=PDFLib;const p=await PDFDocument.create();const b=await f.arrayBuffer();const i=f.type.startsWith('image/png')?await p.embedPng(b):await p.embedJpg(b);const pg=p.addPage([i.width,i.height]);pg.drawImage(i,{x:0,y:0,width:i.width,height:i.height});const pdfBytes=await p.save();d.href=URL.createObjectURL(new Blob([pdfBytes],{type:'application/pdf'}));d.download=`converted.pdf`;d.classList.remove('hidden');s.textContent='Conversion successful!';showResetButton()}catch(e){s.textContent=`Error: ${e.message}`}})});