document.addEventListener('DOMContentLoaded',async()=>{document.getElementById('process-btn').addEventListener('click',async()=>{const f=document.getElementById('file-input').files[0],p=document.getElementById('password').value,d=document.getElementById('download-link'),s=document.getElementById('status');if(!f||!p){alert('Please select a file and enter a password.');return}try{s.textContent='Encrypting PDF...';const{PDFDocument}=PDFLib;const b=await f.arrayBuffer();const doc=await PDFDocument.load(b);await doc.encrypt({userPassword:p,ownerPassword:p});const pdfBytes=await doc.save();d.href=URL.createObjectURL(new Blob([pdfBytes],{type:'application/pdf'}));d.download=`encrypted-${f.name}`;d.classList.remove('hidden');s.textContent='Encryption successful!';showResetButton();}catch(e){s.textContent=`Error: ${e.message}`}})});